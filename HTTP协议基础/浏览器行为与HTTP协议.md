### 输入 url 回车到浏览器展示网站页面处理流程（极简 v0.1）：

1. 输入网址并回车
   进行网络验证，判断网站是否是连通的
2. 解析域名
   访问本地`DNS`服务器， 将人能识别的域名根据本地数据库存储的内容，转化成 ip 地址，这样就知道要访问那个服务器了
3. 浏览器发送 http 请求
   找到了服务器之后，浏览器就能够正式的发送 http 请求了，然后请求走到了反向代理（类似机房）。然后，反向代理在根据代理协议，将这个请求落到某台服务器上。

   这个时候就涉及到发送数据包的过程

4. 如果请求成功了，服务器返回 html
   这是时候，服务器要把响应返回到浏览器端，怎么来的就需要怎么回去，但是可能的是，回的时候走的链路可能不是原来的路了。
   为什么可能不一样的路呢？
   局域网上的设备到服务器，要经过很多路由器，是透明的，正常来说是无感知的，在互联网中，许许多多的路由器组成网，为了网络的健壮性。一个数据的发送需要查找路由表，路由表就会告诉你要先走那个路由，到了一个路由就要继续查找这个路由上的路由表，就会告诉下一个路由的位置，重复这个过程。 就如果一个路由器无法走通，数据可以通过其他路由器，最后经过跳转到达目的地
5. 浏览器处理 html

### TCP/IP 协议栈

| iso/osi 协议 | TCP/IP 协议簇 |
| ------------ | ------------- |
| 应用层       | 应用层        |
| 表示层       |               |
| 会话层       |               |
| 传输层       | 传输层        |
| 网络层       | 网络层        |
| 数据链路层   | 网络接口层    |
| 物理层       |               |

1. 应用层

   > 为用户提供所需要的各种服务，例如：HTTP,FTP,DNS,SMTP

2. 传输层

   > 为应用层实体，提供端到端的通信功能，保证数据包的顺序传送和数据的完整性

3. 网络层
   > 主要解决主机到主机的通信问题，IP 协议是网际互联层最重要的协议
4. 网路接口层
   > 负责监视数据在主机和网路之间交换

### HTTP 工作流程

- 一次 HTTP 操作称为**事务**，其工作过程可分为四步
  - 首先客户机与服务器需要建立连接。只要单击某个超级链接，Http 工作开始
  - 建立连接后，客户机发送一个请求给服务器，请求方式的格式为：统一资源标识符（URL），协议版本号，后面是 MIME 信息包括请求修饰符，客户机信息和可能的内容
  - 服务器接收到请求后，给予相同的响应信息，其格式为一个状态行，包含信息的协议版本号，一个成功或错误的代码，后面是 MIME 信息包含服务器信息，实体信息和可能的内容
  - 客户端接收服务器所返回的信息，通过浏览器显示在用户显示屏上，然后客户机与服务器断开连接
  - 上述过程如果有某一步出现错误，那么产生错误将返回客户端，有显示屏输出。

### 浏览器缓存机制

1. 强制缓存
2. 协商缓存（ETag->last-modified）

有了`LastModified`为什么还要出一个`ETag`

“Etag 主要为了解决 Last-Modified 无法解决的一些问题：
1、一些文件也许会周期性的更改，但是他的内容并不改变(仅仅改变的修改时间)，这个时候我们并不希望客户端认为这个文件被修改了，而重新 GET；
2、某些文件修改非常频繁，比如在秒以下的时间内进行修改，(比方说 1s 内修改了 N 次)，If-Modified-Since 能检查到的粒度是 s 级的，这种修改无法判断(或者说 UNIX 记录 MTIME 只能精确到秒)；
3、某些服务器不能精确的得到文件的最后修改时间。

Last-Modified 也可以弥补 ETag 判断的缺陷，比如一些图片等静态文件的修改
